# ==============================================
# SECURITY-ENHANCED GO TEMPLATE CONFIGURATION
# ==============================================

# ==============================================
# CRITICAL SECURITY SETTINGS
# ==============================================

# JWT Secret - MUST be set in production!
# Generate with: openssl rand -base64 64
JWT_SECRET=your-very-long-random-secret-key-change-this-in-production

# Environment (0=dev, 1=staging, 2=prod)
ENV=0

# ==============================================
# DATABASE CONFIGURATION
# ==============================================

DATABASE_URL=postgres://postgres:postgres@localhost:5432/template_dev
DATABASE_MAX_CONNECTIONS=25
DATABASE_MIN_CONNECTIONS=5
DATABASE_MAX_CONN_LIFETIME=1h
DATABASE_MAX_CONN_IDLE_TIME=10m

# ==============================================
# HTTP/SERVER CONFIGURATION
# ==============================================

PORT=3000
HTTP_BASE_URL=http://localhost:3000
HTTP_HOSTS=localhost,127.0.0.1

# Frontend URL for development proxy
FRONTEND_URL=http://localhost:5173

# ==============================================
# AUTHENTICATION CONFIGURATION
# ==============================================

# Token Lifetimes
AUTH_ACCESS_TOKEN_TTL=15m
AUTH_REFRESH_TOKEN_TTL=168h  # 7 days

# Password Hashing
AUTH_BCRYPT_COST=12  # 10-15 recommended (higher = more secure but slower)

# User Management
AUTH_DEFAULT_ROLE=user
AUTH_REQUIRE_EMAIL_VERIFICATION=false
AUTH_ALLOW_SELF_REGISTRATION=true

# ==============================================
# PASSWORD POLICY CONFIGURATION
# ==============================================

AUTH_PASSWORD_MIN_LENGTH=8
AUTH_PASSWORD_REQUIRE_UPPER=true
AUTH_PASSWORD_REQUIRE_LOWER=true
AUTH_PASSWORD_REQUIRE_NUMBER=true
AUTH_PASSWORD_REQUIRE_SPECIAL=false
AUTH_PASSWORD_HISTORY_LIMIT=5

# ==============================================
# ACCOUNT SECURITY CONFIGURATION
# ==============================================

# Failed Login Protection
AUTH_MAX_LOGIN_ATTEMPTS=5
AUTH_LOCKOUT_DURATION=15m

# MFA (if implementing)
AUTH_ENABLE_MFA=false

# ==============================================
# SECURITY & RATE LIMITING
# ==============================================

# Rate Limiting
SECURITY_RATE_LIMIT_REQUESTS=60
SECURITY_RATE_LIMIT_WINDOW=1m

# Security Features
SECURITY_ENABLE_AUDIT_LOGGING=true
SECURITY_ENABLE_CSRF_PROTECTION=true

# Session Cookies
SECURITY_SESSION_COOKIE_NAME=access_token
SECURITY_SESSION_COOKIE_SECURE=true
SECURITY_SESSION_COOKIE_HTTP_ONLY=true
SECURITY_SESSION_COOKIE_SAME_SITE=strict  # strict|lax|none

# ==============================================
# EMAIL CONFIGURATION (when implemented)
# ==============================================

# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USERNAME=your-email@example.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM_ADDRESS=noreply@yourapp.com
# SMTP_FROM_NAME=Your App Name

# ==============================================
# LOGGING CONFIGURATION
# ==============================================

LOG_LEVEL=info  # debug|info|warn|error
LOG_FORMAT=json # json|console

# ==============================================
# DEVELOPMENT SETTINGS
# ==============================================

# Development mode (affects static file serving)
# DEV_MODE=true

# Hot reload (if implementing)
# DEV_HOT_RELOAD=true

# ==============================================
# PRODUCTION SECURITY NOTES
# ==============================================

# For production deployment:
# 1. Generate a strong JWT_SECRET with: openssl rand -base64 64
# 2. Set ENV=2 for production mode
# 3. Use HTTPS (set SECURITY_SESSION_COOKIE_SECURE=true)
# 4. Configure proper HTTP_HOSTS for your domain
# 5. Enable SSL for database connections
# 6. Set up proper monitoring and alerting
# 7. Configure email settings for notifications
# 8. Review and adjust rate limiting based on your traffic
# 9. Enable audit logging and monitor security events
# 10. Regularly rotate JWT secrets and update dependencies

# ==============================================
# OPTIONAL: EXTERNAL SERVICES
# ==============================================

# Redis (if implementing caching/sessions)
# REDIS_URL=redis://localhost:6379/0

# File Storage (if needed)
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=your-bucket-name

# Monitoring (if implementing)
# SENTRY_DSN=https://your-sentry-dsn
# DATADOG_API_KEY=your-datadog-key

# ==============================================
# FEATURE FLAGS (for gradual rollouts)
# ==============================================

# FEATURE_EMAIL_VERIFICATION=false
# FEATURE_TWO_FACTOR_AUTH=false
# FEATURE_OAUTH_LOGIN=false
# FEATURE_API_RATE_LIMITING=true